def launch_env() {
    sh """
        #!/bin/bash
        make train-up
    """
}

def stop_env() {
    sh """
        #!/bin/bash
        make train-down
    """
}

pipeline {
    agent { label "${EXECUTION_NODE}" }
    parameters {
        string(name: 'SHARED_VOLUME_PATH', defaultValue: '/home/gonzalopardo/Documents/jenkins/HAR-AI-FRAMEWORK/final-dataset', description: 'Path to store dataset shared volume in remote node')
    }
    stages{
        stage('Launch environment') {
            steps{ 
                launch_env()
            }  
        }
        stage('Train') {
            steps{ 
                    sh """
                        #!/bin/bash
                        make -C ./delivery/jenkins train
                    """
            }  
        }
        stage('Stop environment') {
            steps{ 
                stop_env()
            }  
        }
    }
}

